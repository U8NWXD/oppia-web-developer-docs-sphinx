<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lighthouse CI Automated Tests &mdash; Oppia Web Contributor Documentation  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="General Good Practices" href="Testing-for-Accessibility.html" />
    <link rel="prev" title="End to end tests" href="End-to-End-Tests.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Oppia Web Contributor Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Oppia%27s-Mission.html">Oppia’s Mission</a></li>
<li class="toctree-l1"><a class="reference internal" href="Oppia%27s-Mission.html#vision">Vision</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/oppia/oppia/blob/develop/.github/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-involved.html">Get Involved</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developing Oppia</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Frequently-Asked-Questions.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installing-Oppia.html">Installing Oppia</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tips-for-common-IDEs.html">Tips for common IDEs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Make-a-pull-request.html">Make a pull request</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pull-requests-at-Oppia.html">Pull requests at Oppia</a></li>
<li class="toctree-l1"><a class="reference internal" href="Get-help.html">Get help</a></li>
<li class="toctree-l1"><a class="reference internal" href="Learning-Resources.html">Learning resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Git-cheat-sheet.html">Git cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started.html">Get started with the code base</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding-guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="testing.html">Testing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Running-Tests.html">Running tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="Backend-tests.html">Backend tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="Frontend-unit-tests-guide.html">Frontend unit tests guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="End-to-End-Tests.html">End to end tests</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lighthouse CI Automated Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-add-new-pages-to-lighthouse-tests">How to add new pages to lighthouse tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add-a-static-webpage">Add a static webpage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-a-dynamic-webpage">Add a dynamic webpage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#get-the-url">1. Get the URL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#write-the-url-to-stdout">2. Write the URL to stdout</a></li>
<li class="toctree-l3"><a class="reference internal" href="#export-the-url-to-an-environment-variable">3. Export the URL to an environment variable</a></li>
<li class="toctree-l3"><a class="reference internal" href="#call-the-environment-variable-in-the-lighthouse-config">4. Call the environment variable in the lighthouse config</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-lighthouse-tests">Debugging Lighthouse Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="Testing-for-Accessibility.html">General Good Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="Testing-for-Accessibility.html#visual-disabilities">Visual Disabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Testing-for-Accessibility.html#physical-disabilities">Physical Disabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Testing-for-Accessibility.html#hearing-disabilities">Hearing Disabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Release-accessibility-checklist.html">Accessibility Manual Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release process</a></li>
<li class="toctree-l1"><a class="reference internal" href="Events-Team.html">Oppia Events team</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Oppiabot.html">Oppiabot</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend-reference.html">Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend-reference.html">Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="Adding-new-translations-for-i18n.html">Adding new translations for i18n</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-develop-for-i18n.html">How to develop for i18n</a></li>
<li class="toctree-l1"><a class="reference internal" href="Webpack.html">Webpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension-reference.html">Extension frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advice-on-creating-explorations.html">Advice on creating explorations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Oppia-ml-Extension.html">Oppia-ml Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mobile-development.html">Mobile development</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mobile-device-testing.html">Mobile device testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Performance-Testing.html">Performance testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build-process.html">Build process</a></li>
<li class="toctree-l1"><a class="reference internal" href="Team-Structure.html">Team structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks.html">Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="past-events.html">Past Events</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Oppia Web Contributor Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="testing.html">Testing</a> &raquo;</li>
      <li>Lighthouse CI Automated Tests</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Lighthouse-Tests.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="lighthouse-ci-automated-tests">
<h1>Lighthouse CI Automated Tests<a class="headerlink" href="#lighthouse-ci-automated-tests" title="Permalink to this headline"></a></h1>
<p>Lighthouse CI is a suite of tools that make continuously running, saving, retrieving, and asserting against Lighthouse results as easy as possible. Lighthouse has tests for performance, best practices, and accessibility.</p>
<p>To run the automated tests on Oppia. Type the commands
“python -m scripts.run_lighthouse_tests”
or
“python -m scripts.run_lighthouse_accessibility_tests” in the terminal.</p>
<p>The script will run the Oppia server, and then run Lighthouse checks on all the webpages outlined in the lighthouserc.js config. The Lighthouse tests also automatically test against any PR with Github Actions. The accessibility tests run only accessibility audits while the general lighthouse test audits best practices and performance</p>
<p>For further information about lighthouse <a class="reference external" href="https://developers.google.com/web/tools/lighthouse">checkout this page</a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="how-to-add-new-pages-to-lighthouse-tests">
<h1>How to add new pages to lighthouse tests<a class="headerlink" href="#how-to-add-new-pages-to-lighthouse-tests" title="Permalink to this headline"></a></h1>
<p>If you have recently created a new webpage on Oppia, it should be covered by lighthouse tests to ensure that your page is accessible.</p>
<section id="add-a-static-webpage">
<h2>Add a static webpage<a class="headerlink" href="#add-a-static-webpage" title="Permalink to this headline"></a></h2>
<p>If your webpage URL is static and doesn’t require any id generation. Then the only thing you need to do is add your webpage to the lighthouserc.js and lighthouserc-accessibility.js config.</p>
<p>For example, if your webpage is on the URL: <code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:8181/your/static/webpage</span></code>
Just add the URL to the <code class="docutils literal notranslate"><span class="pre">'url'</span></code> list in the config</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  &#39;url&#39;: [
    &#39;http://127.0.0.1:8181/admin&#39;,
    &#39;http://127.0.0.1:8181/your/static/webpage&#39;
  ]
</pre></div>
</div>
</section>
<section id="add-a-dynamic-webpage">
<h2>Add a dynamic webpage<a class="headerlink" href="#add-a-dynamic-webpage" title="Permalink to this headline"></a></h2>
<p>If your webpage URL is dynamic and requires id generation. You will need to generate the id in lighthouse_setup.js and export the id to the lighthouse configs. As an example, we will show how we add the exploration editor to the lighthouse tests.</p>
<section id="get-the-url">
<h3>1. Get the URL<a class="headerlink" href="#get-the-url" title="Permalink to this headline"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">getExplorationEditorUrl</span> <span class="o">=</span> <span class="k">async</span> <span class="n">function</span><span class="p">(</span><span class="n">browser</span><span class="p">,</span> <span class="n">page</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">eslint</span><span class="o">-</span><span class="n">disable</span><span class="o">-</span><span class="nb">next</span><span class="o">-</span><span class="n">line</span> <span class="n">dot</span><span class="o">-</span><span class="n">notation</span>
    <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">goto</span><span class="p">(</span>
      <span class="n">CREATOR_DASHBOARD_URL</span><span class="p">,</span> <span class="p">{</span> <span class="n">waitUntil</span><span class="p">:</span> <span class="n">networkIdle</span> <span class="p">});</span>

    <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">waitForSelector</span><span class="p">(</span><span class="n">createButtonSelector</span><span class="p">,</span> <span class="p">{</span><span class="n">visible</span><span class="p">:</span> <span class="n">true</span><span class="p">});</span>
    <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">click</span><span class="p">(</span><span class="n">createButtonSelector</span><span class="p">);</span>
    <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">waitForSelector</span><span class="p">(</span>
      <span class="n">dismissCreateModalSelector</span><span class="p">,</span> <span class="p">{</span><span class="n">visible</span><span class="p">:</span> <span class="n">true</span><span class="p">});</span>
    <span class="n">explorationEditorUrl</span> <span class="o">=</span> <span class="k">await</span> <span class="n">page</span><span class="o">.</span><span class="n">url</span><span class="p">();</span>
  <span class="p">}</span> <span class="n">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">//</span> <span class="n">eslint</span><span class="o">-</span><span class="n">disable</span><span class="o">-</span><span class="nb">next</span><span class="o">-</span><span class="n">line</span> <span class="n">no</span><span class="o">-</span><span class="n">console</span>
    <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
</section>
</section>
<section id="write-the-url-to-stdout">
<h2>2. Write the URL to stdout<a class="headerlink" href="#write-the-url-to-stdout" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="k">await</span> <span class="n">getExplorationEditorUrl</span><span class="p">(</span><span class="n">browser</span><span class="p">,</span> <span class="n">page</span><span class="p">);</span>
  <span class="k">await</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
    <span class="p">[</span>
      <span class="n">explorationEditorUrl</span><span class="p">,</span>
    <span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="p">);</span>
</pre></div>
</div>
</section>
<section id="export-the-url-to-an-environment-variable">
<h2>3. Export the URL to an environment variable<a class="headerlink" href="#export-the-url-to-an-environment-variable" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">export_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Exports the url to an environmental variable.&quot;&quot;&quot;</span>
    <span class="n">url_list</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;create&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;exploration_editor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">url_list</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="call-the-environment-variable-in-the-lighthouse-config">
<h2>4. Call the environment variable in the lighthouse config<a class="headerlink" href="#call-the-environment-variable-in-the-lighthouse-config" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      &#39;url&#39;: [
        &#39;http://127.0.0.1:8181/admin&#39;,
        `http://127.0.0.1:8181/create/${process.env.exploration_editor}`,
      ]
    },
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="debugging-lighthouse-tests">
<h1>Debugging Lighthouse Tests<a class="headerlink" href="#debugging-lighthouse-tests" title="Permalink to this headline"></a></h1>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="End-to-End-Tests.html" class="btn btn-neutral float-left" title="End to end tests" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Testing-for-Accessibility.html" class="btn btn-neutral float-right" title="General Good Practices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, The Oppia Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>