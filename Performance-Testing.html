<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performance testing &mdash; Oppia Web Contributor Documentation  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Build process" href="Build-process.html" />
    <link rel="prev" title="Mobile device testing" href="Mobile-device-testing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Oppia Web Contributor Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Oppia%27s-Mission.html">Oppia’s Mission</a></li>
<li class="toctree-l1"><a class="reference internal" href="Oppia%27s-Mission.html#vision">Vision</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/oppia/oppia/blob/develop/.github/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-involved.html">Get Involved</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developing Oppia</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Frequently-Asked-Questions.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installing-Oppia.html">Installing Oppia</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tips-for-common-IDEs.html">Tips for common IDEs</a></li>
<li class="toctree-l1"><a class="reference internal" href="Make-a-pull-request.html">Make a pull request</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pull-requests-at-Oppia.html">Pull requests at Oppia</a></li>
<li class="toctree-l1"><a class="reference internal" href="Get-help.html">Get help</a></li>
<li class="toctree-l1"><a class="reference internal" href="Learning-Resources.html">Learning resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Git-cheat-sheet.html">Git cheat sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="get-started.html">Get started with the code base</a></li>
<li class="toctree-l1"><a class="reference internal" href="coding-guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release process</a></li>
<li class="toctree-l1"><a class="reference internal" href="Events-Team.html">Oppia Events team</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Oppiabot.html">Oppiabot</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend-reference.html">Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend-reference.html">Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="Adding-new-translations-for-i18n.html">Adding new translations for i18n</a></li>
<li class="toctree-l1"><a class="reference internal" href="How-to-develop-for-i18n.html">How to develop for i18n</a></li>
<li class="toctree-l1"><a class="reference internal" href="Webpack.html">Webpack</a></li>
<li class="toctree-l1"><a class="reference internal" href="extension-reference.html">Extension frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advice-on-creating-explorations.html">Advice on creating explorations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Oppia-ml-Extension.html">Oppia-ml Extension</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mobile-development.html">Mobile development</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mobile-device-testing.html">Mobile device testing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-tests">Running tests.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-framework">The Framework.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metrics-that-we-consider">Metrics that we consider.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-tests">Writing tests.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#raw-stats-that-we-have">Raw stats that we have.</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#issues">Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Build-process.html">Build process</a></li>
<li class="toctree-l1"><a class="reference internal" href="Team-Structure.html">Team structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks.html">Playbooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="past-events.html">Past Events</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Oppia Web Contributor Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Performance testing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Performance-Testing.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="performance-testing">
<h1>Performance testing<a class="headerlink" href="#performance-testing" title="Permalink to this headline"></a></h1>
<section id="running-tests">
<h2>Running tests.<a class="headerlink" href="#running-tests" title="Permalink to this headline"></a></h2>
<p>To run performance tests for all pages:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">scripts.run_performance_tests</span></code></p>
<p>To run test for a specific page:
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">scripts.run_performance_tests</span> <span class="pre">--test_name=page_test</span></code></p>
<p>page_test is the name of the file containing that test eg. splash_test. Refer to <code class="docutils literal notranslate"><span class="pre">core/tests/performance_tests</span></code> directory for the files containing these tests.</p>
</section>
<section id="the-framework">
<h2>The Framework.<a class="headerlink" href="#the-framework" title="Permalink to this headline"></a></h2>
<p>The framework has two major components to it:</p>
<ol class="simple">
<li><p>Performance Data Fetcher:
We use selenium and browsermob-proxy to fetch performance data for the different Oppia pages.
Selenium helps in programmatically interacting with a browser and browsermob-proxy is used to capture HTTP Archive (referred to as HAR) data by recording the communication between the client and server.
The <strong>HTTP Archive</strong> format is a JSON-formatted archive file format used for logging a web browser’s interaction with a site. It contains detailed performance data, including information about page loading and displaying and per-resource statistics. Each entry contains the URL requested and request and response headers. For additional details, please see: https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/HAR/Overview.html</p></li>
<li><p>Performance Metrics Provider:
Refer to: <code class="docutils literal notranslate"><span class="pre">PageSessionMetrics</span></code> and <code class="docutils literal notranslate"><span class="pre">MultiplePageSessionMetrics</span></code> objects in <code class="docutils literal notranslate"><span class="pre">perf_domain.py</span></code>.</p></li>
</ol>
</section>
<section id="metrics-that-we-consider">
<h2>Metrics that we consider.<a class="headerlink" href="#metrics-that-we-consider" title="Permalink to this headline"></a></h2>
<p>We consider the following metrics for the first time a user opens a page as well as for a return user (to test caching of various resources).</p>
<ol class="simple">
<li><p>Total page size.</p></li>
<li><p>Total page load time.</p></li>
<li><p>Dom ready time.</p></li>
<li><p>Request time.</p></li>
</ol>
<p><strong>What to do if tests fails?</strong></p>
<p>If it is something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">page_metrics</span><span class="o">.</span><span class="n">get_page_load_time_millisecs</span><span class="p">(),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="ne">AssertionError</span><span class="p">:</span> <span class="mi">3715</span> <span class="ow">not</span> <span class="n">less</span> <span class="n">than</span> <span class="ow">or</span> <span class="n">equal</span> <span class="n">to</span> <span class="mi">3000</span>
</pre></div>
</div>
<p>This means that the threshold set for this metric is not met. This could happen due to:</p>
<ol class="simple">
<li><p>You introduced a change which alters the value of the metric. In this case, there is an increase in the total page load time.</p></li>
<li><p>This could also happen due to variability in timings from machine to machine. Make sure that these tests are the <strong>only</strong> (major) active process running.</p></li>
</ol>
</section>
<section id="writing-tests">
<h2>Writing tests.<a class="headerlink" href="#writing-tests" title="Permalink to this headline"></a></h2>
<p>To write tests for a new Oppia page:</p>
<ol class="simple">
<li><p>Create a new file in <code class="docutils literal notranslate"><span class="pre">core/tests/performance_tests/</span></code> following similar name conventions to the existing test files there, i.e it should be something like <code class="docutils literal notranslate"><span class="pre">pagename_test.py</span></code>.</p></li>
<li><p>This folder also contains <code class="docutils literal notranslate"><span class="pre">test_config.py</span></code>, config file for performance tests. Add a unique key for the new page and add a dictionary entry containing thresholds for different metrics to the <code class="docutils literal notranslate"><span class="pre">TEST_DATA</span></code> object. Also, add corresponding <code class="docutils literal notranslate"><span class="pre">preload_options</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base.py</span></code> has some utility functions for tests which should be used to record page metrics.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">core/tests/performance_framework/perf_domain.py</span></code> has functions starting with <code class="docutils literal notranslate"><span class="pre">get_metric_name</span></code> that give us the quantitative value for that metric. In case you require any other metric, add it to the same file. Also, refer to description regarding the raw stats that we have.</p></li>
</ol>
<section id="raw-stats-that-we-have">
<h3>Raw stats that we have.<a class="headerlink" href="#raw-stats-that-we-have" title="Permalink to this headline"></a></h3>
<ol class="simple">
<li><p>Page session statistics.</p></li>
<li><p>Page session load timings.</p></li>
</ol>
</section>
</section>
<section id="issues">
<h2>Issues<a class="headerlink" href="#issues" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">WebDriverException:</span> <span class="pre">Message:</span> <span class="pre">chrome</span> <span class="pre">not</span> <span class="pre">reachable</span></code>:
Try setting bypass proxy for local addresses if you are behind a proxy server.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Mobile-device-testing.html" class="btn btn-neutral float-left" title="Mobile device testing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Build-process.html" class="btn btn-neutral float-right" title="Build process" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, The Oppia Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>